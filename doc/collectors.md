# 采集器的使用流程设计

## 核心价值定位

采集器作为系统中数据采集的执行者，是连接监控平台与被监控设备的桥梁。添加完成后，其使用流程应当简洁且高效，以下是完整的使用路径：

## 采集器使用路径

### 1. 采集器分配与关联

- 设备关联：在设备管理模块，为每个设备选择适合的采集器

- 区域划分：根据网络拓扑结构，合理分配采集器负责的设备范围，避免跨网段采集导致的性能问题

### 2. 指标配置

- 采集能力标记：每种采集器应明确支持的指标类型

- 协议配置：根据设备类型配置采集协议（SNMP/SSH/API等）

- 参数设置：配置采集间隔、超时时间、重试策略等采集参数

### 3. 任务调度集成

- 采集任务创建：在任务调度模块创建任务时，系统应自动筛选出能够采集指定设备指定指标的采集器

- 负载均衡：系统根据采集器当前负载自动分配任务，或允许管理员手动指定

### 4. 运行监控

- 健康状态：监控采集器自身的运行状态、资源使用率

- 采集成功率：展示各采集器的数据采集成功率、响应时间等KPI

- 异常诊断：提供采集失败的原因分析和故障排除建议

### 5. 维护管理

- 版本升级：支持采集器的远程升级

- 配置同步：支持采集器配置的批量修改和同步

- 替换迁移：支持采集器故障时的任务迁移和无缝替换

## 用户体验设计要点

1. 透明性：用户无需深入理解采集器内部工作原理，只需关注"要监控什么"

1. 自动化：大部分采集器选择和任务分配应自动进行，减少手动操作

1. 可视化：提供采集路径和数据流转的可视化展示，帮助理解系统工作状态

1. 问题自愈：采集器故障时能够自动切换或重试，保障数据连续性

从产品使用角度看，理想的采集器应当是"存在但无感"的组件——它确保数据可靠采集，但用户的主要关注点仍然是设备、指标和数据本身，而非采集器的技术细节。



# 采集器与调度系统集成架构设计

## 核心架构组件

### 1. 采集器注册与发现机制

text

Apply to CollectorSer...

┌─────────────────┐   ┌─────────────────┐   ┌─────────────────┐

│        									   │   │         									  │   │        									   │

│ 采集器管理服务 │◄────►│  注册中心   │◄────►│  任务调度服务 │

│         									  │   │         									  │   │         									  │

└─────────────────┘   └─────────────────┘   └─────────────────┘

​    ▲                      																									   ▲

​    │                        																									   │

​    ▼                         																									▼

┌─────────────────┐            										   ┌─────────────────┐

│         │               │         │

│  采集器实例  │◄─────────────────────────────►│  任务执行引擎 │

│         │               │         │

└─────────────────┘              										 └─────────────────┘

### 2. 技术实现路径

#### (1) 采集器身份识别与注册

方案设计:

- 为每个采集器生成全局唯一标识符(GUID)

- 采集器启动时通过HTTP/HTTPS或消息队列向注册中心发送注册请求

- 注册信息包含：采集器ID、IP地址、支持的采集协议、资源能力、网络位置等

实现细节:

java

Apply to CollectorSer...

*// 采集器启动类*

public class CollectorBootstrap {

  public void start() {

​    CollectorInfo info = new CollectorInfo(

​      generateGuid(),

​      getHostAddress(),

​      getCapabilities(),

​      getNetworkLocation()

​    );

​    

​    *// 向注册中心注册*

​    registryClient.register(info);

​    

​    *// 启动心跳服务*

​    heartbeatService.start();

  }

}

#### (2) 健康检查与状态维护

方案设计:

- 采集器定期(如30秒)发送心跳到注册中心

- 注册中心维护采集器状态表，标记在线/离线/异常状态

- 支持主动探测机制，定期检查采集器健康状态

健康检查协议:

text

Apply to CollectorSer...

{

 "collector_id": "collector-001",

 "timestamp": 1629458762,

 "status": "HEALTHY",

 "metrics": {

  "cpu_usage": 0.35,

  "memory_usage": 0.42,

  "active_tasks": 12

 },

 "capabilities": ["SNMP", "JMX", "HTTP"]

}

#### (3) 采集能力映射

方案设计:

- 建立指标类型与采集协议的映射关系

- 采集器声明自身支持的采集协议和指标类型

- 系统自动建立"设备-指标-采集器"的能力映射表

映射表设计:

sql

Apply to CollectorSer...

CREATE TABLE collector_capabilities (

  id BIGINT PRIMARY KEY,

  collector_id VARCHAR(64),

  metric_type VARCHAR(50),

  protocol VARCHAR(30),

  device_type VARCHAR(50),

  priority INT,

  performance_factor FLOAT

);

#### (4) 任务调度系统集成

方案设计:

- 任务调度服务在创建任务时查询能力映射表

- 基于设备类型、指标类型、网络位置等筛选合适的采集器

- 支持负载均衡、地理位置优先等高级调度策略

调度算法:

java

Apply to CollectorSer...

public CollectorInstance selectCollector(Device device, Metric metric) {

  *// 1. 筛选支持该设备和指标的采集器*

  List<CollectorInstance> candidates = collectorRegistry.findByCapability(

​    device.getType(), metric.getType(), metric.getProtocol());

  

  *// 2. 按网络位置筛选(同网段优先)*

  candidates = candidates.stream()

​    .filter(c -> isNetworkProximity(c, device))

​    .sorted(byNetworkDistance(device))

​    .collect(Collectors.toList());

  

  *// 3. 考虑负载均衡*

  candidates.sort(byCurrentLoad());

  

  *// 4. 返回最优选择*

  return candidates.isEmpty() ? null : candidates.get(0);

}

#### (5) 任务执行与数据回传

方案设计:

- 采集器提供统一的任务接收API(如HTTP/HTTPS或消息队列)

- 调度服务将任务推送到选定的采集器

- 采集器执行任务并通过数据通道回传结果

- 支持异步回传和批量回传以提高效率

数据流设计:

text

Apply to CollectorSer...

调度服务 --[任务分发]--> 采集器实例

采集器实例 --[数据采集]--> 目标设备

采集器实例 --[结果回传]--> 数据接收服务

数据接收服务 --[数据处理]--> 存储服务

### 3. 高可用与容错设计

- 多级故障转移: 采集器故障时自动选择备用采集器

- 缓存机制: 在注册中心和调度服务中缓存采集器信息，防止单点故障

- 状态恢复: 采集器重启后能够恢复之前的任务状态

- 数据冗余: 对关键采集任务可配置多个采集器同时采集，保证数据可靠性

### 4. 扩展性考虑

- 水平扩展: 采集器集群支持动态扩展，新增采集器自动纳入调度范围

- 插件机制: 采集器支持插件式扩展新的协议和指标类型

- 动态配置: 支持采集器配置的远程更新，无需重启

- 多租户隔离: 支持按租户或业务域隔离采集器资源

## 实施建议

1. 渐进式演进:

- 第一阶段: 实现基本的采集器注册和心跳机制

- 第二阶段: 加入能力映射和基础调度逻辑

- 第三阶段: 完善高级特性(负载均衡、故障转移等)

1. 技术选型:

- 注册中心可考虑使用Consul/Zookeeper/Eureka

- 消息通信层推荐Kafka/RabbitMQ

- 采集器与服务间的API使用REST或gRPC

1. 监控与可观测性:

- 对采集器本身进行监控，收集性能指标

- 维护采集任务执行历史，便于问题排查

- 提供采集路径可视化，帮助理解系统行为

这种架构设计使采集器能够自动融入监控体系，实现"即插即用"，同时保持了系统的灵活性和可靠性。





# 采集器交互页面设计分析

## 当前页面的局限性

从架构设计角度看，现有的采集器配置页面可能存在以下不足：

1. 身份关联缺失：无法将系统中创建的采集器记录与实际运行的采集器程序建立映射关系

1. 能力声明不足：未明确展示采集器支持的协议、指标类型和设备类型

1. 状态监控欠缺：缺乏采集器实时状态、健康度和资源使用情况的可视化

1. 网络拓扑缺失：未体现采集器在网络中的位置，无法优化采集路径

1. 调度关系不明：无法直观展示采集器与设备、任务的关联关系

## 理想交互页面设计

### 1. 采集器管理主视图

text

Apply to CollectorSer...

┌─────────────────────────────────────────────────────────────────────┐

│ 采集器管理                    + 新增 ↻ 刷新 ⋮  │

├─────────────────────────────────────────────────────────────────────┤

│ ◉ 状态概览                             │

├────────────┬────────────┬────────────┬────────────┬─────────────────┤

│ 总数: 12  │ 在线: 10  │ 离线: 1  │ 告警: 1  │ 总负载率: 42%  │

└────────────┴────────────┴────────────┴────────────┴─────────────────┘

┌─────────────────────────────────────────────────────────────────────┐

│ 采集器列表 [全部▼] [状态▼] [类型▼] [网络区域▼]  🔍 搜索...    │

├────┬────────────┬─────────┬───────────┬──────────┬─────────┬────────┤

│ # │ 名称    │ 状态  │ 版本   │ IP地址  │ 负载率 │ 操作  │

├────┼────────────┼─────────┼───────────┼──────────┼─────────┼────────┤

│ 1 │ collector-1│ ● 在线 │ v2.1.3  │10.0.1.15 │ 35%   │ ···  │

├────┼────────────┼─────────┼───────────┼──────────┼─────────┼────────┤

│ 2 │ collector-2│ ● 在线 │ v2.1.3  │10.0.2.18 │ 67%   │ ···  │

├────┼────────────┼─────────┼───────────┼──────────┼─────────┼────────┤

│ 3 │ collector-3│ ○ 离线 │ v2.1.2  │10.0.3.22 │ —    │ ···  │

├────┼────────────┼─────────┼───────────┼──────────┼─────────┼────────┤

│ 4 │ collector-4│ ⚠ 告警 │ v2.1.3  │10.0.1.16 │ 92%   │ ···  │

└────┴────────────┴─────────┴───────────┴──────────┴─────────┴────────┘

### 2. 采集器详情页面

text

Apply to CollectorSer...

┌─────────────────────────────────────────────────────────────────────┐

│ 采集器详情 > collector-1             编辑 重启 删除  │

├─────────────────────────────────────────────────────────────────────┤

│ [基本信息] [采集能力] [关联设备] [当前任务] [监控指标] [日志]    │

└─────────────────────────────────────────────────────────────────────┘

┌─基本信息───────────────────────────┐ ┌─状态监控───────────────────────┐

│ ID: collector-001-xyz       │ │ ┌───────┐ ┌───────┐ ┌───────┐│

│ 名称: 核心区服务器采集器      │ │ │ CPU  │ │ 内存 │ │ 任务 ││

│ 部署位置: 主数据中心A区      │ │ │ 35%  │ │ 42%  │ │ 12/50 ││

│ IP地址: 10.0.1.15         │ │ └───────┘ └───────┘ └───────┘│

│ 版本: v2.1.3            │ │                │

│ 启动时间: 2023-06-15 08:30:42   │ │ 采集成功率: 99.8%       │

│ 运行时长: 15天4小时        │ │ 平均响应时间: 43ms       │

└──────────────────────────────────────┴────────────────────────────────┘

┌─采集能力───────────────────────────────────────────────────────────────┐

│ ┌────────────┬─────────────────┬────────────────┬───────────────────┐ │

│ │ 协议    │ 支持指标类型  │ 适用设备类型  │ 性能系数     │ │

│ ├────────────┼─────────────────┼────────────────┼───────────────────┤ │

│ │ SNMP    │ 系统性能, 网络 │ 服务器, 网络  │ 高        │ │

│ │ JMX    │ Java应用性能  │ 中间件服务器  │ 中        │ │

│ │ HTTP/API  │ Web服务状态   │ 应用服务器   │ 高        │ │

│ └────────────┴─────────────────┴────────────────┴───────────────────┘ │

└─────────────────────────────────────────────────────────────────────────┘

┌─关联设备 (15)────────────────────────────────────────────────────────┐

│ [按设备类型▼] [按状态▼]               + 关联新设备  │

│ ┌────────────┬────────────────┬─────────────┬────────────────────┐  │

│ │ 设备名称  │ 设备类型    │ 关联指标数 │ 上次采集状态    │  │

│ ├────────────┼────────────────┼─────────────┼────────────────────┤  │

│ │ server-01 │ 物理服务器   │ A类(5)   │ ● 成功       │  │

│ │ server-02 │ 物理服务器   │ A类(5)   │ ● 成功       │  │

│ │ switch-01 │ 交换机     │ B类(3)   │ ● 成功       │  │

│ │ oas-server │ 应用服务器   │ C类(4)   │ ⚠ 部分失败     │  │

│ └────────────┴────────────────┴─────────────┴────────────────────┘  │

└─────────────────────────────────────────────────────────────────────────┘

### 3. 采集器注册与激活流程

text

Apply to CollectorSer...

┌─采集器注册──────────────────────────────────────────────────────────────┐

│ 步骤1: 创建采集器记录 > 步骤2: 安装与配置 > 步骤3: 激活与验证   │

└──────────────────────────────────────────────────────────────────────────┘

┌─步骤1: 创建采集器记录──────────────────────────────────────────────────┐

│ 采集器名称*: [核心区服务器采集器_____________]            │

│ 采集器类型*: [标准采集器▼]                      │

│ 网络区域*:  [主数据中心A区▼]                     │

│ 描述:    [负责核心区服务器与网络设备的指标采集__________________] │

│                                    │

│ 支持的采集协议: [✓] SNMP [✓] JMX [✓] HTTP/API [ ] WMI [ ] SSH   │

│                                    │

│ 注册令牌有效期: [24小时▼]  自动生成密钥: [✓]            │

│                       [下一步 >]        │

└───────────────────────────────────────────────────────────────────────┘

┌─步骤2: 安装与配置────────────────────────────────────────────────────────┐

│ 采集器注册令牌:                             │

│ ┌──────────────────────────────────────────────────────────────────┐   │

│ │ eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjb2xsZWN0b3JfaWQiOiJjMD   │

│ └──────────────────────────────────────────────────────────────────┘   │

│                                [复制]   │

│ 安装说明:                                 │

│ 1. 在目标服务器上下载并安装采集器软件包                 │

│  [下载采集器 v2.1.3]                          │

│                                     │

│ 2. 配置采集器并使用上述令牌进行注册:                   │

│  ```                                  │

│  ./collector --register --token=<令牌> --server=https://skyeye.com/api │

│  ```                                  │

│                          [< 上一步] [下一步 >] │

└──────────────────────────────────────────────────────────────────────────┘

┌─步骤3: 激活与验证────────────────────────────────────────────────────────┐

│ ◔ 等待采集器连接... (3分钟超时)                     │

│                                     │

│ 采集器尚未连接到系统，请确保:                      │

│ - 采集器软件已正确安装                          │

│ - 注册命令已正确执行                           │

│ - 网络连接正常，防火墙允许采集器访问系统API               │

│                                     │

│ [手动检查连接]          [重新生成令牌]              │

│                                     │

│                          [< 上一步] [完成设置] │

└──────────────────────────────────────────────────────────────────────────┘

### 4. 网络拓扑与采集路径可视化

text

Apply to CollectorSer...

┌─采集器网络拓扑───────────────────────────────────────────────────────────┐

│                            [⛶] [⚙] [🔍+] [🔍-] │

│                                     │

│    ┌─────────────┐                          │

│    │ 数据中心A区 │                          │

│    └─────┬───────┘                          │

│       │                              │

│   ┌───────┴────────┐                         │

│   │        │                         │

│ ┌────▼─────┐   ┌────▼─────┐                      │

│ │collector1│────►│server-01 │                      │

│ └────┬─────┘   └──────────┘                      │

│   │        ▲                         │

│   │        │                         │

│ ┌────▼─────┐     │                         │

│ │server-02 │◄─────────┘                         │

│ └──────────┘                               │

│                                     │

└──────────────────────────────────────────────────────────────────────────┘

## 采集器注册与身份关联的关键功能

1. 令牌注册机制

- 生成唯一注册令牌，限时有效

- 采集器通过令牌自动关联到系统记录

- 支持批量部署的自动化注册流程

1. 能力自动发现

- 采集器启动后自动报告支持的协议

- 根据采集器版本自动填充指标支持矩阵

- 提供手动调整能力声明的界面

1. 健康监控整合

- 采集器本身的CPU、内存、硬盘等资源指标

- 采集任务执行统计：成功率、响应时间

- 异常事件记录与告警设置

1. 调度关系可视化

- 直观展示采集器负责的设备范围

- 显示当前执行中的任务数量与状态

- 提供任务与采集器的关联视图

## 实施建议

现有采集器配置页面应升级为完整的"采集器管理中心"，分阶段实施：

1. 第一阶段：添加令牌注册机制，实现身份关联

1. 第二阶段：增强状态监控与能力声明功能

1. 第三阶段：添加网络拓扑与调度关系可视化

这种设计使采集器从单纯的配置记录转变为可管理、可监控的系统组件，大幅提升系统的可用性和可维护性。





# SkyEye 智能监控系统 - 采集器管理模块原型设计

## 1. 采集器管理主页面

```
┌──────────────────────────────────────────────────────────────────────────┐
│ SkyEye > 系统设置 > 采集器管理                                           │
├──────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐                     │
│  │ 12      │  │ 10      │  │ 1       │  │ 1       │                     │
│  │ 总数量  │  │ 在线    │  │ 离线    │  │ 告警    │                     │
│  └─────────┘  └─────────┘  └─────────┘  └─────────┘                     │
│                                                                          │
│  采集器列表                                           + 新增采集器 刷新  │
│  ┌────────────────────────────────────────────────────────────────────┐  │
│  │ 状态▼  类型▼  网络区域▼                          🔍 搜索...        │  │
│  ├────┬─────────────┬─────────┬──────────┬───────────┬───────┬────────┤  │
│  │ #  │ 名称        │ 状态    │ 版本     │ IP地址    │ 负载  │ 操作   │  │
│  ├────┼─────────────┼─────────┼──────────┼───────────┼───────┼────────┤  │
│  │ 1  │ 核心区采集器│         │          │           │       │        │  │
│  │    │             │ ● 在线  │ v2.1.3   │10.0.1.15  │ 35%   │ ⋯     │  │
│  ├────┼─────────────┼─────────┼──────────┼───────────┼───────┼────────┤  │
│  │ 2  │ 网络设备采集│         │          │           │       │        │  │
│  │    │             │ ● 在线  │ v2.1.3   │10.0.2.18  │ 67%   │ ⋯     │  │
│  ├────┼─────────────┼─────────┼──────────┼───────────┼───────┼────────┤  │
│  │ 3  │ 应用服务采集│         │          │           │       │        │  │
│  │    │             │ ○ 离线  │ v2.1.2   │10.0.3.22  │ --    │ ⋯     │  │
│  ├────┼─────────────┼─────────┼──────────┼───────────┼───────┼────────┤  │
│  │ 4  │ 备用采集器  │         │          │           │       │        │  │
│  │    │             │ ⚠ 告警  │ v2.1.3   │10.0.1.16  │ 92%   │ ⋯     │  │
│  └────┴─────────────┴─────────┴──────────┴───────────┴───────┴────────┘  │
│                                                                          │
│  * 操作菜单: 查看详情 | 编辑 | 重启 | 删除 | 分配设备                   │
│                                                                          │
└──────────────────────────────────────────────────────────────────────────┘
```

## 2. 采集器详情页面

```
┌──────────────────────────────────────────────────────────────────────────┐
│ SkyEye > 系统设置 > 采集器管理 > 核心区采集器                            │
├──────────────────────────────────────────────────────────────────────────┤
│                                                    编辑  重启  删除       │
│  ┌─────────────────────────────────────────────────────────────────────┐  │
│  │ 基本信息  采集能力  关联设备  当前任务  监控指标  日志              │  │
│  └─────────────────────────────────────────────────────────────────────┘  │
│                                                                          │
│  【基本信息】                                                            │
│  ┌────────────────────────────────┐  ┌───────────────────────────────┐   │
│  │ ID: collector-001-xyz          │  │            CPU使用率          │   │
│  │ 名称: 核心区采集器             │  │  ┌───────────────────┐ 35%    │   │
│  │ 部署位置: 主数据中心A区        │  │  █████████░░░░░░░░░░░│        │   │
│  │ IP地址: 10.0.1.15             │  │  └───────────────────┘        │   │
│  │ 版本: v2.1.3                  │  │                               │   │
│  │ 启动时间: 2023-06-15 08:30:42  │  │            内存使用率         │   │
│  │ 运行时长: 15天4小时            │  │  ┌───────────────────┐ 42%    │   │
│  │                                │  │  ████████████░░░░░░░░│        │   │
│  │ 描述:                          │  │  └───────────────────┘        │   │
│  │ 负责核心区服务器与网络设备的   │  │                               │   │
│  │ 指标采集                      │  │  采集成功率: 99.8%            │   │
│  │                                │  │  平均响应时间: 43ms           │   │
│  └────────────────────────────────┘  └───────────────────────────────┘   │
│                                                                          │
└──────────────────────────────────────────────────────────────────────────┘
```

## 3. 采集能力标签页

```
┌──────────────────────────────────────────────────────────────────────────┐
│ SkyEye > 系统设置 > 采集器管理 > 核心区采集器                            │
├──────────────────────────────────────────────────────────────────────────┤
│                                                    编辑  重启  删除       │
│  ┌─────────────────────────────────────────────────────────────────────┐  │
│  │ 基本信息  采集能力  关联设备  当前任务  监控指标  日志              │  │
│  └─────────────────────────────────────────────────────────────────────┘  │
│                                                                          │
│  【采集能力】                                                            │
│  ┌────────────────────────────────────────────────────────────────────┐   │
│  │ ● 支持的协议                                                       │   │
│  │                                                                    │   │
│  │   [SNMP v2/v3]   [JMX]   [HTTP/API]   [SSH]                        │   │
│  │                                                                    │   │
│  │ ● 支持的指标类型                                                   │   │
│  │                                                                    │   │
│  │   [系统性能]   [网络指标]   [存储指标]   [中间件性能]              │   │
│  │   [数据库指标] [应用指标]   [日志分析]   [自定义指标]              │   │
│  │                                                                    │   │
│  │ ● 适用设备类型                                                     │   │
│  │                                                                    │   │
│  │   [服务器]     [网络设备]   [存储设备]   [中间件服务器]            │   │
│  │   [数据库服务器] [Web服务器] [应用服务器] [监控探针]               │   │
│  │                                                                    │   │
│  │ ● 指标采集矩阵                                                     │   │
│  │  ┌────────────┬─────────────────┬───────────────┬───────────────┐  │   │
│  │  │ 指标类型   │ 采集协议        │ 适用设备      │ 性能评级      │  │   │
│  │  ├────────────┼─────────────────┼───────────────┼───────────────┤  │   │
│  │  │ 系统性能   │ SNMP, SSH       │ 服务器        │ ★★★★☆      │  │   │
│  │  │ 网络指标   │ SNMP            │ 网络设备      │ ★★★★★      │  │   │
│  │  │ 中间件性能 │ JMX             │ 中间件服务器  │ ★★★☆☆      │  │   │
│  │  │ 应用指标   │ HTTP/API        │ 应用服务器    │ ★★★★☆      │  │   │
│  │  └────────────┴─────────────────┴───────────────┴───────────────┘  │   │
│  └────────────────────────────────────────────────────────────────────┘   │
│                                                                          │
└──────────────────────────────────────────────────────────────────────────┘
```

## 4. 关联设备标签页

```
┌──────────────────────────────────────────────────────────────────────────┐
│ SkyEye > 系统设置 > 采集器管理 > 核心区采集器                            │
├──────────────────────────────────────────────────────────────────────────┤
│                                                    编辑  重启  删除       │
│  ┌─────────────────────────────────────────────────────────────────────┐  │
│  │ 基本信息  采集能力  关联设备  当前任务  监控指标  日志              │  │
│  └─────────────────────────────────────────────────────────────────────┘  │
│                                                                          │
│  【关联设备】                                          + 关联设备        │
│  ┌────────────────────────────────────────────────────────────────────┐   │
│  │ 设备类型▼  状态▼                                   🔍 搜索...      │   │
│  │                                                                    │   │
│  │ ┌────┬─────────────┬───────────────┬──────────────┬─────────────┐  │   │
│  │ │ #  │ 设备名称    │ 设备类型      │ 关联指标数   │ 采集状态    │  │   │
│  │ ├────┼─────────────┼───────────────┼──────────────┼─────────────┤  │   │
│  │ │ 1  │ server-01   │ 物理服务器    │ 15           │ ● 正常      │  │   │
│  │ ├────┼─────────────┼───────────────┼──────────────┼─────────────┤  │   │
│  │ │ 2  │ server-02   │ 物理服务器    │ 15           │ ● 正常      │  │   │
│  │ ├────┼─────────────┼───────────────┼──────────────┼─────────────┤  │   │
│  │ │ 3  │ switch-01   │ 交换机        │ 10           │ ● 正常      │  │   │
│  │ ├────┼─────────────┼───────────────┼──────────────┼─────────────┤  │   │
│  │ │ 4  │ oas-server  │ 应用服务器    │ 12           │ ⚠ 部分失败  │  │   │
│  │ └────┴─────────────┴───────────────┴──────────────┴─────────────┘  │   │
│  │                                                                    │   │
│  │                                                     1/3页 < 1 2 3 >│   │
│  └────────────────────────────────────────────────────────────────────┘   │
│                                                                          │
└──────────────────────────────────────────────────────────────────────────┘
```

## 5. 新增采集器 - 第1步

```
┌──────────────────────────────────────────────────────────────────────────┐
│                        新增采集器                                    ✕   │
├──────────────────────────────────────────────────────────────────────────┤
│  ┌────────────────────────────────────────────────────────────────────┐  │
│  │ 步骤1: 创建采集器  >  步骤2: 配置与部署  >  步骤3: 激活与验证     │  │
│  └────────────────────────────────────────────────────────────────────┘  │
│                                                                          │
│  【基础信息】                                                            │
│  采集器名称*                                                             │
│  ┌────────────────────────────────────────────────────────────────────┐  │
│  │ 核心区采集器                                                       │  │
│  └────────────────────────────────────────────────────────────────────┘  │
│                                                                          │
│  采集器类型*                       网络区域*                             │
│  ┌───────────────────────┐         ┌───────────────────────┐             │
│  │ 标准采集器         ▼ │         │ 主数据中心A区      ▼ │             │
│  └───────────────────────┘         └───────────────────────┘             │
│                                                                          │
│  描述                                                                    │
│  ┌────────────────────────────────────────────────────────────────────┐  │
│  │ 负责核心区服务器与网络设备的指标采集                              │  │
│  └────────────────────────────────────────────────────────────────────┘  │
│                                                                          │
│  【采集能力】                                                            │
│                                                                          │
│  支持的协议                                                              │
│  [✓] SNMP   [✓] JMX   [✓] HTTP/API   [ ] WMI   [ ] SSH                  │
│                                                                          │
│  注册令牌有效期    [ 24小时 ▼ ]      [✓] 自动生成加密密钥               │
│                                                                          │
│                                                      取消   [下一步 >]   │
└──────────────────────────────────────────────────────────────────────────┘
```

## 6. 新增采集器 - 第2步

```
┌──────────────────────────────────────────────────────────────────────────┐
│                        新增采集器                                    ✕   │
├──────────────────────────────────────────────────────────────────────────┤
│  ┌────────────────────────────────────────────────────────────────────┐  │
│  │ 步骤1: 创建采集器  >  步骤2: 配置与部署  >  步骤3: 激活与验证     │  │
│  └────────────────────────────────────────────────────────────────────┘  │
│                                                                          │
│  【采集器部署】                                                          │
│                                                                          │
│  采集器注册令牌                                                          │
│  ┌────────────────────────────────────────────────────────────────────┐  │
│  │ eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjb2xsZWN0b3JfaWQiOiJjMD  │  │
│  └────────────────────────────────────────────────────────────────────┘  │
│                                                             [复制令牌]   │
│                                                                          │
│  部署说明                                                                │
│  ┌────────────────────────────────────────────────────────────────────┐  │
│  │ 1. 在目标服务器上下载并安装采集器软件包                            │  │
│  │    [下载采集器 v2.1.3]                                             │  │
│  │                                                                    │  │
│  │ 2. 配置并启动采集器，使用上述令牌进行注册:                         │  │
│  │    ```                                                             │  │
│  │    ./collector --register --token=<令牌>                           │  │
│  │               --server=https://skyeye.yourdomain.com/api           │  │
│  │    ```                                                             │  │
│  │                                                                    │  │
│  │ 3. 采集器将自动连接至系统并进行注册                                │  │
│  └────────────────────────────────────────────────────────────────────┘  │
│                                                                          │
│  令牌有效期: 23小时55分钟                                               │
│                                                                          │
│                                               [< 上一步]   [下一步 >]   │
└──────────────────────────────────────────────────────────────────────────┘
```

## 7. 新增采集器 - 第3步

```
┌──────────────────────────────────────────────────────────────────────────┐
│                        新增采集器                                    ✕   │
├──────────────────────────────────────────────────────────────────────────┤
│  ┌────────────────────────────────────────────────────────────────────┐  │
│  │ 步骤1: 创建采集器  >  步骤2: 配置与部署  >  步骤3: 激活与验证     │  │
│  └────────────────────────────────────────────────────────────────────┘  │
│                                                                          │
│  【采集器激活】                                                          │
│                                                                          │
│  ┌────────────────────────────────────────────────────────────────────┐  │
│  │                      等待采集器连接...                             │  │
│  │                                                                    │  │
│  │                         ◔                                          │  │
│  │                                                                    │  │
│  │                   (等待时间: 1:25 / 3:00)                          │  │
│  └────────────────────────────────────────────────────────────────────┘  │
│                                                                          │
│  采集器状态: 未连接                                                      │
│                                                                          │
│  如果采集器未能成功连接，请检查:                                         │
│  • 采集器软件是否正确安装且已启动                                        │
│  • 注册令牌是否正确使用                                                  │
│  • 网络连接是否正常，防火墙是否允许采集器访问系统API                     │
│  • 服务器时间是否同步                                                    │
│                                                                          │
│  [检查连接状态]                              [重新生成令牌]              │
│                                                                          │
│                                               [< 上一步]   [完成设置]    │
└──────────────────────────────────────────────────────────────────────────┘
```

## 8. 关联设备弹窗

```
┌──────────────────────────────────────────────────────────────────────────┐
│                        关联设备                                      ✕   │
├──────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│  选择要关联到采集器"核心区采集器"的设备:                                 │
│                                                                          │
│  ┌────────────────────────────────────────────────────────────────────┐  │
│  │ 设备类型▼  状态▼  网络区域▼                      🔍 搜索...       │  │
│  │                                                                    │  │
│  │ [✓] 全选                                                          │  │
│  │                                                                    │  │
│  │ ┌───┬────────────┬──────────────┬──────────────┬─────────────────┐ │  │
│  │ │   │ 设备名称   │ 设备类型     │ IP地址       │ 当前采集器      │ │  │
│  │ ├───┼────────────┼──────────────┼──────────────┼─────────────────┤ │  │
│  │ │[✓]│ server-05  │ 物理服务器   │ 10.0.1.25    │ 未分配          │ │  │
│  │ ├───┼────────────┼──────────────┼──────────────┼─────────────────┤ │  │
│  │ │[✓]│ server-06  │ 物理服务器   │ 10.0.1.26    │ 未分配          │ │  │
│  │ ├───┼────────────┼──────────────┼──────────────┼─────────────────┤ │  │
│  │ │[ ]│ switch-02  │ 交换机       │ 10.0.1.254   │ 网络设备采集器  │ │  │
│  │ ├───┼────────────┼──────────────┼──────────────┼─────────────────┤ │  │
│  │ │[✓]│ redis-srv  │ 中间件服务器 │ 10.0.1.30    │ 未分配          │ │  │
│  │ └───┴────────────┴──────────────┴──────────────┴─────────────────┘ │  │
│  │                                                                    │  │
│  │                                             1/5页  < 1 2 3 4 5 >   │  │
│  └────────────────────────────────────────────────────────────────────┘  │
│                                                                          │
│  ● 已选择 3 个设备                                                      │
│                                                                          │
│  是否同时配置这些设备的采集指标?                                         │
│  ( ) 否，仅建立关联                                                      │
│  (•) 是，应用推荐指标模板                                                │
│  ( ) 是，选择指定模板: [ 请选择... ▼ ]                                  │
│                                                                          │
│                                                      取消   [确认关联]   │
└──────────────────────────────────────────────────────────────────────────┘
```

## 9. 采集器网络拓扑视图

```
┌──────────────────────────────────────────────────────────────────────────┐
│ SkyEye > 系统设置 > 采集器管理 > 网络拓扑                                │
├──────────────────────────────────────────────────────────────────────────┤
│                                                      [⛶] [🔍+] [🔍-] ⚙   │
│  ┌────────────────────────────────────────────────────────────────────┐  │
│  │                      ┌──────────────┐                              │  │
│  │                      │ SkyEye服务器 │                              │  │
│  │                      └──────┬───────┘                              │  │
│  │                             │                                      │  │
│  │                             ▼                                      │  │
│  │                   ┌───────────────────┐                            │  │
│  │                   │   网络核心交换机  │                            │  │
│  │                   └──┬─────────────┬──┘                            │  │
│  │                      │             │                               │  │
│  │         ┌────────────┴──┐       ┌──┴────────────┐                  │  │
│  │         ▼               │       │               ▼                  │  │
│  │ ┌──────────────┐        │       │        ┌──────────────┐          │  │
│  │ │ 核心区采集器 │        │       │        │ 网络设备采集器│          │  │
│  │ └───────┬──────┘        │       │        └───────┬──────┘          │  │
│  │         │               ▼       ▼              │                   │  │
│  │         │       ┌──────────────────────┐       │                   │  │
│  │         │       │      应用区交换机    │       │                   │  │
│  │         │       └───────────┬──────────┘       │                   │  │
│  │         │                   │                  │                   │  │
│  │         ▼                   ▼                  ▼                   │  │
│  │ ┌──────────────┐    ┌──────────────┐    ┌──────────────┐          │  │
│  │ │   server-01  │    │   server-02  │    │   switch-01  │          │  │
│  │ └──────────────┘    └──────────────┘    └──────────────┘          │  │
│  │                                                                    │  │
│  │ 图例:  ● 在线采集器   ○ 离线采集器   ■ 服务器   ♦ 网络设备       │  │
│  │                                                                    │  │
│  │ 视图: [网络拓扑] [地理位置] [业务分组]      [自动刷新: 30秒]      │  │
│  └────────────────────────────────────────────────────────────────────┘  │
│                                                                          │
└──────────────────────────────────────────────────────────────────────────┘
```

这些原型设计遵循了现代企业管理系统的UI风格，强调了以下几点：

1. **信息层次清晰**：通过卡片、标签页和表格组织信息
2. **操作流程引导**：采用步骤式向导引导用户完成复杂操作
3. **状态可视化**：使用颜色和图标直观表示状态信息
4. **功能模块化**：相关功能集中在一个页面，通过标签页切换
5. **专业性与可用性平衡**：既满足专业用户的需求，又保持界面简洁易用

这套页面原型完整覆盖了采集器的生命周期管理，从创建、配置、关联设备到监控状态，为用户提供了完整的采集器管理体验。



根据您的要求，我已经成功创建了三个采集器相关的原型HTML文件：

1. collector_management.html - 采集器管理主页面

- 展示所有采集器列表

- 提供添加、编辑、删除、详情等操作入口

- 显示采集器状态和基本信息

1. collector_detail.html - 采集器详情页面

- 基本信息展示（ID、名称、版本、部署位置等）

- 状态监控（CPU、内存、任务负载等）

- 采集能力展示（支持的协议、指标类型等）

- 分选项卡显示相关信息

1. collector_add.html - 采集器添加页面

- 三步流程：创建采集器、配置与部署、激活与验证

- 支持设置采集器基本信息和支持的协议

- 提供注册令牌和部署说明

- 等待采集器连接和验证

1. collector_config.html - 采集器配置页面

- 设备关联配置（添加/移除设备）

- 指标配置与统计

- 批量配置功能

- 设备和指标的分布统计